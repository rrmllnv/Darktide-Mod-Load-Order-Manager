# Darktide Mod Load Order Manager

Программа для управления порядком загрузки модов Warhammer 40,000: Darktide.

## Описание

Приложение позволяет легко включать и выключать моды, редактируя файл `mod_load_order.txt`. Моды, начинающиеся с `--`, считаются отключенными, остальные - активными.

## Требования

- Node.js 16 или выше
- npm (обычно устанавливается вместе с Node.js)

## Установка

1. Убедитесь, что Node.js установлен на вашем компьютере
2. Скачайте или склонируйте проект:
   ```bash
   git clone https://github.com/rrmllnv/Darktide-Mod-Load-Order-Manager.git
   ```
3. Откройте командную строку в папке проекта
4. Выполните команду:
   ```bash
   npm install
   ```

## Запуск

### Вариант 1: Через bat-файлы (рекомендуется)

- **`run-start.bat`** - основной скрипт запуска с проверкой ошибок и автоматической установкой зависимостей
- **`run-quick.bat`** - быстрый запуск без дополнительных проверок
- **`run-dev.bat`** - запуск в режиме разработки с открытыми инструментами разработчика
- **`run-build.bat`** - сборка приложения для распространения

Просто дважды кликните по любому из этих файлов.

### Вариант 2: Через командную строку

```bash
cd путь\к\Darktide-Mod-Load-Order-Manager
npm start
```

Или напрямую через Electron:

```bash
npx electron .
```

### Вариант 3: Режим разработки

```bash
npm run dev
```

Это запустит приложение с открытыми инструментами разработчика.

## Использование

1. Запустите приложение
2. Укажите путь к файлу `mod_load_order.txt` (по умолчанию используется стандартный путь Steam)
3. Используйте чекбоксы для включения/выключения модов
4. Нажмите "Сохранить" для применения изменений

## Функции

- Просмотр всех модов из файла `mod_load_order.txt`
- Включение/выключение модов через чекбоксы
- Массовое включение/выключение всех модов
- Автоматическое сохранение заголовка файла
- Сортировка модов (по порядку файла, по имени, по статусу, новые сначала)
- Поиск и фильтрация модов
- Перемещение модов вверх/вниз в списке (drag & drop)
- Быстрое переключение (включить только один мод)
- Система профилей (сохранение/загрузка/переименование/удаление состояний модов)
- Автоматическое сканирование папки модов для поиска новых
- Обнаружение удаленных модов (помечаются как "Удалено")
- Обнаружение симлинков (помечаются как "[SYMLINK]")
- Скрытие удаленных модов (опционально)
- Статистика (всего, включено, выключено)
- Валидация и обработка ошибок
- Создание симлинков для модов

## Расположение файла

По умолчанию программа ищет файл по пути:
```
C:\Program Files (x86)\Steam\steamapps\common\Warhammer 40,000 DARKTIDE\mods\mod_load_order.txt
```

Вы можете указать другой путь через кнопку "Обзор..." или вручную в поле пути.

## Профили

Приложение автоматически создает папку `ModLoadOrderManager_profiles` в директории модов для хранения профилей. Профили сохраняют состояние всех модов (включен/выключен) и позволяют быстро переключаться между различными конфигурациями.

### Управление профилями

- **Создание профиля**: Введите имя нового профиля и нажмите "Сохранить профиль"
- **Загрузка профиля**: Выберите профиль из списка и нажмите "Загрузить профиль"
- **Перезапись профиля**: Выберите существующий профиль и нажмите "Перезаписать профиль" для обновления его состояния
- **Переименование профиля**: Выберите профиль и нажмите "Переименовать профиль"
- **Удаление профиля**: Выберите профиль и нажмите "Удалить профиль"

## Решение проблем

### Ошибка "npm не распознан"

Если при запуске появляется ошибка о том, что команда не распознана:

1. Убедитесь, что Node.js установлен:
   - Откройте командную строку
   - Введите `node --version` или `npm --version`
   - Если команда не работает, установите Node.js с [nodejs.org](https://nodejs.org/)

2. Добавьте Node.js в PATH:
   - При установке Node.js выберите опцию "Add to PATH"
   - Или добавьте путь к Node.js вручную в системные переменные

### Ошибка при установке зависимостей

Если `npm install` выдает ошибки:

1. Убедитесь, что у вас установлена последняя версия Node.js
2. Попробуйте очистить кэш npm:
   ```bash
   npm cache clean --force
   ```
3. Удалите папку `node_modules` и файл `package-lock.json`, затем выполните `npm install` снова

### Приложение не запускается

1. Проверьте, что все файлы на месте:
   - `main.js`, `preload.js` в корне проекта
   - `app/index.html`, `app/renderer.js`, `app/styles.css`
   - Папки `app/models/`, `app/services/`, `app/ui/`, `app/utils/`
2. Убедитесь, что Electron установлен (выполните `npm install`)
3. Проверьте консоль на наличие ошибок (запустите через `npm run dev` или `run-dev.bat`)

## Сборка для распространения

Приложение использует `electron-builder` для создания установщиков и портативных версий.

### Сборка через bat-файл (рекомендуется)

Просто запустите `run-build.bat` - скрипт автоматически установит зависимости и выполнит сборку.

### Сборка через командную строку

```bash
npm run build
```

Собранные файлы будут находиться в папке `dist/`:
- **NSIS установщик**: `Darktide Mod Load Order Manager Setup.exe`
- **Портативная версия**: `Darktide Mod Load Order Manager.exe`

### Дополнительные команды сборки

```bash
npm run build:win    # Сборка только для Windows
npm run build:dir    # Сборка без установщика (только распакованные файлы)
```

## Структура проекта

```
Darktide-Mod-Load-Order-Manager/
├── app/                    # Основная папка приложения
│   ├── icons/             # Иконки приложения
│   ├── models/            # Модели данных (ModEntry)
│   ├── services/          # Сервисы (FileService, ModScanService, ProfileService)
│   ├── ui/                # UI компоненты (ModalManager, DragDropManager, и т.д.)
│   ├── utils/             # Утилиты (Sorter, StatusManager)
│   ├── index.html         # Главная HTML страница
│   ├── renderer.js        # Основная логика рендерера
│   └── styles.css         # Стили приложения
├── main.js                # Главный процесс Electron
├── preload.js             # Preload скрипт для безопасности
├── package.json           # Конфигурация проекта и зависимостей
├── LICENSE.txt            # Лицензия MIT
└── run-*.bat              # Скрипты для запуска и сборки
```

## Технические детали

- **Платформа**: Electron 27.x
- **Язык**: JavaScript (ES6+)
- **Архитектура**: Модульная структура с разделением на модели, сервисы, UI и утилиты
- **Сборка**: electron-builder с поддержкой NSIS установщика и портативной версии
- **Лицензия**: MIT

## Репозиторий

- **GitHub**: [https://github.com/rrmllnv/Darktide-Mod-Load-Order-Manager](https://github.com/rrmllnv/Darktide-Mod-Load-Order-Manager)
- **Issues**: [https://github.com/rrmllnv/Darktide-Mod-Load-Order-Manager/issues](https://github.com/rrmllnv/Darktide-Mod-Load-Order-Manager/issues)
