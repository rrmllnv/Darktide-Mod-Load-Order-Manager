const { contextBridge, ipcRenderer } = require('electron');

contextBridge.exposeInMainWorld('electronAPI', {
  getDefaultPath: () => ipcRenderer.invoke('get-default-path'),
  fileExists: (filePath) => ipcRenderer.invoke('file-exists', filePath),
  loadFile: (filePath) => ipcRenderer.invoke('load-file', filePath),
  saveFile: (filePath, content) => ipcRenderer.invoke('save-file', filePath, content),
  selectFile: (defaultPath) => ipcRenderer.invoke('select-file', defaultPath),
  scanModsDirectory: (modsDir) => ipcRenderer.invoke('scan-mods-directory', modsDir),
  getProfilesDirectory: (modsDir) => ipcRenderer.invoke('get-profiles-directory', modsDir),
  listProfiles: (profilesDir) => ipcRenderer.invoke('list-profiles', profilesDir),
  saveProfile: (profilesDir, profileName, state) => ipcRenderer.invoke('save-profile', profilesDir, profileName, state),
  loadProfile: (profilesDir, profileName) => ipcRenderer.invoke('load-profile', profilesDir, profileName),
  deleteProfile: (profilesDir, profileName) => ipcRenderer.invoke('delete-profile', profilesDir, profileName),
  renameProfile: (profilesDir, oldName, newName) => ipcRenderer.invoke('rename-profile', profilesDir, oldName, newName),
  createSymlink: (linkPath, targetPath) => ipcRenderer.invoke('create-symlink', linkPath, targetPath),
  selectFolder: (defaultPath) => ipcRenderer.invoke('select-folder', defaultPath),
  loadUserConfig: () => ipcRenderer.invoke('load-user-config'),
  saveUserConfig: (userConfig) => ipcRenderer.invoke('save-user-config', userConfig),
  checkIsDirectory: (filePath) => ipcRenderer.invoke('check-is-directory', filePath),
  copyFolderToMods: (sourcePath, modsDir) => ipcRenderer.invoke('copy-folder-to-mods', sourcePath, modsDir),
  findModLoadOrderFile: () => ipcRenderer.invoke('find-mod-load-order-file'),
  launchDtkitPatch: (gameDir) => ipcRenderer.invoke('launch-dtkit-patch', gameDir),
  openFile: (filePath) => ipcRenderer.invoke('open-file', filePath),
  openFolder: (folderPath) => ipcRenderer.invoke('open-folder', folderPath),
  createModStructure: (projectPath, modName) => ipcRenderer.invoke('create-mod-structure', projectPath, modName),
  deleteFolder: (folderPath) => ipcRenderer.invoke('delete-folder', folderPath),
  getBackupsDirectory: () => ipcRenderer.invoke('get-backups-directory'),
  createBackup: (projectPath, modName, comment) => ipcRenderer.invoke('create-backup', projectPath, modName, comment),
  listBackups: (modName) => ipcRenderer.invoke('list-backups', modName),
  listModsWithBackups: () => ipcRenderer.invoke('list-mods-with-backups'),
  restoreBackup: (projectPath, modName, versionName) => ipcRenderer.invoke('restore-backup', projectPath, modName, versionName),
  deleteBackup: (modName, versionName) => ipcRenderer.invoke('delete-backup', modName, versionName),
  updateBackupComment: (modName, versionName, comment) => ipcRenderer.invoke('update-backup-comment', modName, versionName, comment),
  getTodosDirectory: () => ipcRenderer.invoke('get-todos-directory'),
  loadTodos: (todosDir, modName, options) => ipcRenderer.invoke('load-todos', todosDir, modName, options),
  loadAllTodos: (todosDir) => ipcRenderer.invoke('load-all-todos', todosDir),
  addTodo: (todosDir, modName, todo) => ipcRenderer.invoke('add-todo', todosDir, modName, todo),
  updateTodo: (todosDir, modName, todoId, updatedTodo) => ipcRenderer.invoke('update-todo', todosDir, modName, todoId, updatedTodo),
  deleteTodo: (todosDir, modName, todoId) => ipcRenderer.invoke('delete-todo', todosDir, modName, todoId),
  updateTodosFile: (todosDir, modName, todos) => ipcRenderer.invoke('update-todos-file', todosDir, modName, todos),
  copyModFolderToClipboard: (folderPath) => ipcRenderer.invoke('copy-mod-folder-to-clipboard', folderPath),
  getConsoleLogsPath: () => ipcRenderer.invoke('get-console-logs-path'),
  renameMod: (projectPath, oldName, newName, todosDir) => ipcRenderer.invoke('rename-mod', projectPath, oldName, newName, todosDir),
  checkModHasBackups: (modName) => ipcRenderer.invoke('check-mod-has-backups', modName),
  checkModHasTodos: (modName) => ipcRenderer.invoke('check-mod-has-todos', modName),
  deleteModBackups: (modName) => ipcRenderer.invoke('delete-mod-backups', modName),
  deleteModTodos: (modName) => ipcRenderer.invoke('delete-mod-todos', modName)
});
